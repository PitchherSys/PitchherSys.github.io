<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Blog</title>
<link rel="stylesheet" href="style.css">
<style>
  /* Ensure panel background is solid enough for blog items */
  #blog {
    background: rgba(6,20,38,0.85);
    padding: 20px;
    border-radius: 12px;
    position: relative;
    z-index: 1;
  }

  .floating-backdrop {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.25);
    z-index: 999;
    pointer-events: auto;
    opacity: 0;
    transition: opacity 0.25s ease;
  }

  .floating-backdrop.active {
    opacity: 1;
  }

  .floating-window {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.95);
    background: rgba(6,20,38,0.95);
    backdrop-filter: blur(10px) saturate(160%);
    max-width: 90%;
    max-height: 80%;
    overflow-y: auto;
    padding: 25px;
    border-radius: 12px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.5);
    z-index: 1000;
    opacity: 0;
    pointer-events: auto;
    transition: transform 0.25s ease, opacity 0.25s ease;
  }

  .floating-window.active {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }

  .floating-close {
    display: inline-block;
    background-color: #ff4c4c;
    color: #fff;
    border: none;
    border-radius: 5px;
    padding: 8px 12px;
    cursor: pointer;
    font-size: 14px;
    margin-bottom: 15px;
  }
  
</style>
</head>
<body>
<div class="container">

  <!-- floating background bubbles -->
  <div class="bubble-container"></div>

  <!-- header + scrolling text -->
  <div class="header-wrapper">
    <header>
      <div class="logo" aria-hidden="true"></div>
      <h1>Blogs</h1>
    </header>

    <div class="scrolling-text-container">
      <div class="scrolling-text">
        <p>Welcome! Check out my blogs here! I mainly talk about technology related subjects.</p>
      </div>
    </div>
  </div>

  <!-- content -->
  <div class="content-wrapper">
    <nav class="sidebar" aria-label="Main navigation">
      <h3>Main Content</h3>
      <div class="nav">
        <a href="index.html">Introduction</a>
        <a href="projects.html">Projects</a>
        <a href="contact.html">Contact</a>
        <a href="blog.html" class="active">Blog</a>
      </div>
    </nav>

    <main>
      <section class="panel" id="blog">
        <h2>Blog Posts</h2>
        <div id="blog-list" class="blog-list"></div>
      </section>
    </main>
  </div>

  <footer>
    <div>Â© 2025 The Prince of Life</div>
  </footer>
</div>

<!-- Scripts -->
<script src="blog-posts.js"></script>
<script>
const blogList = document.getElementById("blog-list");
let floatingWindow = null;
let floatingBackdrop = null;

// show placeholder if no posts
if (blogPosts.length === 0) {
  const placeholder = document.createElement("div");
  placeholder.classList.add("blog-placeholder");
  placeholder.innerText = "Nothing here yet, check back later!";
  blogList.appendChild(placeholder);
} else {
  function createPostElement(post) {
    const article = document.createElement("article");
    article.classList.add("blog-item");
    article.dataset.id = post.id;
    article.innerHTML = `
      <h3>${post.title} <a href="#${post.id}" title="Shareable link">ðŸ”—</a></h3>
      <p class="date">${post.date}</p>
      <p>${post.preview}</p>
      <button class="glossy-button">Read More</button>
      <div class="full-content">${post.content}</div>
    `;
    return article;
  }

  blogPosts.forEach(post => blogList.appendChild(createPostElement(post)));
}

// click handler for Read More button
blogList.addEventListener("click", e => {
  if (!e.target.matches(".glossy-button")) return;

  const article = e.target.closest(".blog-item");
  if (!article) return;

  const fullContent = article.querySelector(".full-content");

  if (floatingWindow) floatingWindow.remove();
  if (floatingBackdrop) floatingBackdrop.remove();

  // backdrop
  floatingBackdrop = document.createElement("div");
  floatingBackdrop.classList.add("floating-backdrop");
  document.body.appendChild(floatingBackdrop);
  requestAnimationFrame(() => floatingBackdrop.classList.add("active"));

  // modal
  floatingWindow = document.createElement("div");
  floatingWindow.classList.add("floating-window");
  floatingWindow.innerHTML = `
    <button class="floating-close">Close</button>
    <h3>${article.querySelector("h3").childNodes[0].textContent.trim()}</h3>
    <p class="date">${article.querySelector(".date").innerText}</p>
    ${fullContent.innerHTML}
  `;
  document.body.appendChild(floatingWindow);
  requestAnimationFrame(() => floatingWindow.classList.add("active"));

  const close = () => {
    if (!floatingWindow || !floatingBackdrop) return;

    floatingWindow.classList.remove("active");
    floatingBackdrop.classList.remove("active");

    floatingWindow.addEventListener("transitionend", () => {
      floatingWindow?.remove();
      floatingWindow = null;
    }, { once: true });

    floatingBackdrop.addEventListener("transitionend", () => {
      floatingBackdrop?.remove();
      floatingBackdrop = null;
    }, { once: true });
  };

  floatingWindow.querySelector(".floating-close").addEventListener("click", close);
  floatingBackdrop.addEventListener("click", close);
});

window.addEventListener("load", () => {
  const hash = window.location.hash.substring(1);
  if (hash) {
    const targetPost = document.querySelector(`.blog-item[data-id="${hash}"] .glossy-button`);
    if (targetPost) targetPost.click();
  }
});

window.addEventListener("keydown", e => {
  if (e.key === "Escape" && floatingWindow) {
    floatingWindow.querySelector(".floating-close").click();
  }
});
</script>
<script src="script.js"></script>
</body>
</html>
