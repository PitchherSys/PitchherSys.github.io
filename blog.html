<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<!-- meta for mobile stuff, because yes, some people still browse on phones -->
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Blog</title>

<link rel="stylesheet" href="style.css">

<style>
  /* blog container stuff */
  .blog-list { display: flex; flex-direction: column; gap: 15px; margin-top: 10px; }

  /* each blog post panel */
  .blog-item {
    padding: 12px;
    border: 2px solid #80c0ff;
    border-radius: 10px;
    background: linear-gradient(to bottom, #ffffff, #d0ebff);
    box-shadow: inset 0 2px 4px rgba(255,255,255,0.4);
    word-wrap: break-word;
    overflow-wrap: break-word;
    position: relative;
  }

  .blog-item h3 { margin-bottom: 4px; text-shadow: 1px 1px 0 #fff; }
  .blog-item .date { font-size: 0.9em; color: #041006; margin-bottom: 6px; }
  .blog-item p { margin-bottom: 8px; }

  /* hidden full content placeholder */
  .full-content { display: none; }

  /* placeholder when there are no posts */
  .blog-placeholder {
    font-style: italic;
    color: #555;
    text-align: center;
    margin: 20px 0;
    padding: 15px;
    border: 2px dashed #80c0ff;
    border-radius: 10px;
    background: linear-gradient(to bottom, #f0f8ff, #d0ebff);
  }

  /* backdrop for floating post modal */
  .floating-backdrop {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.25);
    backdrop-filter: blur(2px);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.25s ease;
    z-index: 9998;
  }
  .floating-backdrop.active { opacity: 1; pointer-events: all; }

  /* floating window styling */
  .floating-window {
    position: fixed;
    top: 50%; left: 50%;
    transform: translate(-50%, -60%) scale(0.9);
    width: 90%; max-width: 900px; max-height: 90%;
    padding: 20px; border-radius: 12px;
    background: linear-gradient(to bottom, #ffffff, #d0ebff);
    box-shadow: 0 8px 24px rgba(0,0,0,0.5), inset 0 2px 6px rgba(255,255,255,0.4);
    overflow: auto;
    opacity: 0;
    z-index: 9999;
    transition: transform 0.35s cubic-bezier(0.25, 1.2, 0.5, 1), opacity 0.35s ease;
  }
  .floating-window.active {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }

  .floating-window h3 { margin-top: 0; text-shadow: 1px 1px 0 #fff; }
  .floating-window .date { font-size: 0.9em; color:#041006; margin-bottom:12px; }

  /* close button */
  .floating-close { position: absolute; top: 12px; right: 12px; }

  /* code blocks */
  pre code {
    display: block;
    background: #e0f0ff;
    padding: 8px;
    border: 1px solid #80c0ff;
    border-radius: 6px;
    font-family: "Courier New", monospace;
    overflow-x:auto;
  }

  img { max-width: 100%; border-radius: 8px; }

  /* scrollbar for floating window */
  .floating-window::-webkit-scrollbar { width: 8px; }
  .floating-window::-webkit-scrollbar-thumb { background-color: rgba(0,0,0,0.2); border-radius: 4px; }
</style>
</head>
<body>
<div class="container">

  <!-- header + scrolling text -->
  <div class="header-wrapper">
    <header>
      <div class="logo" aria-hidden="true">
        <!-- reused SVG logo, because copy/paste > reinvent -->
      </div>
      <h1>Blogs</h1>
    </header>

    <div class="scrolling-text-container">
      <div class="scrolling-text">
        <p>Welcome! Check out my blogs here! I mainly talk about technology related subjects.</p>
      </div>
    </div>
  </div>

  <div class="content-wrapper">
    <!-- sidebar nav -->
    <nav class="sidebar" aria-label="Main navigation">
      <h3>Main Content</h3>
      <div class="nav">
        <a href="index.html">Introduction</a>
        <a href="projects.html">Projects</a>
        <a href="contact.html">Contact</a>
        <a href="blog.html" class="active">Blog</a>
        <!-- TODO: maybe auto-update latest post highlight someday -->
      </div>
    </nav>

    <!-- main content -->
    <main>
      <section class="panel" id="blog">
        <h2>Blog Posts</h2>
        <div id="blog-list" class="blog-list"></div>
      </section>
    </main>
  </div>

  <!-- footer -->
  <footer>
    <div>Â© 2025 The Prince of Life</div>
  </footer>
</div>

<!-- Scripts -->
<script src="blog-posts.js"></script>
<script>
const blogList = document.getElementById("blog-list");

let floatingWindow = null;
let floatingBackdrop = null;

// show placeholder if no posts (aka lazy dev excuse)
if (blogPosts.length === 0) {
  const placeholder = document.createElement("div");
  placeholder.classList.add("blog-placeholder");
  placeholder.innerText = "Nothing here yet, check back later!";
  blogList.appendChild(placeholder);
} else {
  // function to generate post elements
  function createPostElement(post) {
    const article = document.createElement("article");
    article.classList.add("blog-item");
    article.dataset.id = post.id;
    article.innerHTML = `
      <h3>${post.title} <a href="#${post.id}" title="Shareable link">ðŸ”—</a></h3>
      <p class="date">${post.date}</p>
      <p>${post.preview}</p>
      <button class="glossy-button">Read More</button>
      <div class="full-content">${post.content}</div>
    `;
    return article;
  }

  // render posts
  blogPosts.forEach(post => blogList.appendChild(createPostElement(post)));
}

// click handler for Read More button
blogList.addEventListener("click", e => {
  if (!e.target.matches(".glossy-button")) return;

  const article = e.target.closest(".blog-item");
  if (!article) return; // guard against placeholder

  const fullContent = article.querySelector(".full-content");

  // remove previous floating window/backdrop if any
  if (floatingWindow) floatingWindow.remove();
  if (floatingBackdrop) floatingBackdrop.remove();

  // create backdrop
  floatingBackdrop = document.createElement("div");
  floatingBackdrop.classList.add("floating-backdrop");
  document.body.appendChild(floatingBackdrop);
  requestAnimationFrame(() => floatingBackdrop.classList.add("active"));

  // create floating window
  floatingWindow = document.createElement("div");
  floatingWindow.classList.add("floating-window");
  floatingWindow.innerHTML = `
    <button class="glossy-button floating-close">Close</button>
    <h3>${article.querySelector("h3").childNodes[0].textContent.trim()}</h3>
    <p class="date">${article.querySelector(".date").innerText}</p>
    ${fullContent.innerHTML}
  `;
  document.body.appendChild(floatingWindow);
  requestAnimationFrame(() => floatingWindow.classList.add("active"));

  // close function scoped per floating window
  const close = () => {
    if (!floatingWindow || !floatingBackdrop) return;

    floatingWindow.classList.remove("active");
    floatingBackdrop.classList.remove("active");

    floatingWindow.addEventListener("transitionend", () => {
      floatingWindow?.remove();
      floatingWindow = null;
    }, { once: true });

    floatingBackdrop.addEventListener("transitionend", () => {
      floatingBackdrop?.remove();
      floatingBackdrop = null;
    }, { once: true });
  };

  // attach close listeners
  floatingWindow.querySelector(".floating-close").addEventListener("click", close);
  floatingBackdrop.addEventListener("click", close);
});

// open post if URL hash present
window.addEventListener("load", () => {
  const hash = window.location.hash.substring(1);
  if (hash) {
    const targetPost = document.querySelector(`.blog-item[data-id="${hash}"] .glossy-button`);
    if (targetPost) targetPost.click();
  }
});

// close floating window with Escape key (standard dev shortcut)
window.addEventListener("keydown", e => {
  if (e.key === "Escape" && floatingWindow) {
    floatingWindow.querySelector(".floating-close").click();
  }
});
</script>
</body>
</html>

<!-- HOLY FUCKING SHT IM DONE I DID IT I CAN FINALLY REST OH MY GOD -->